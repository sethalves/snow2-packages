(define-library (seth minecraft-nbt tests)
  (export run-tests)
  (import (scheme base)
          (scheme write)
          (snow extio)
          (seth minecraft-nbt))
  (begin

    (define test-data
      #u8(10 0 0 10 0 4 68 97 116 97 1 0 10 116
             104 117 110 100 101 114 105 110 103 0 4 0 10 76 97
             115 116 80 108 97 121 101 100 0 0 1 74 215 3 12
             150 4 0 7 68 97 121 84 105 109 101 0 0 0 0 0 51
             239 140 1 0 16 68 105 102 102 105 99 117 108 116
             121 76 111 99 107 101 100 0 3 0 16 99 108 101 97
             114 87 101 97 116 104 101 114 84 105 109 101 0 0 0
             0 6 0 13 66 111 114 100 101 114 67 101 110 116 101
             114 90 0 0 0 0 0 0 0 0 1 0 11 105 110 105 116 105
             97 108 105 122 101 100 1 6 0 13 66 111 114 100 101
             114 67 101 110 116 101 114 88 0 0 0 0 0 0 0 0 4 0
             10 82 97 110 100 111 109 83 101 101 100 0 0 0 0
             100 253 167 146 6 0 10 66 111 114 100 101 114 83
             105 122 101 65 140 156 56 0 0 0 0 3 0 7 118 101
             114 115 105 111 110 0 0 74 189 6 0 20 66 111 114
             100 101 114 83 105 122 101 76 101 114 112 84 97
             114 103 101 116 65 140 156 56 0 0 0 0 4 0 4 84 105
             109 101 0 0 0 0 0 44 44 72 1 0 13 97 108 108 111
             119 67 111 109 109 97 110 100 115 0 3 0 6 83 112
             97 119 110 88 255 255 255 179 3 0 6 83 112 97 119
             110 89 0 0 0 64 1 0 8 104 97 114 100 99 111 114
             101 0 3 0 6 83 112 97 119 110 90 0 0 0 222 8 0 9
             76 101 118 101 108 78 97 109 101 0 24 69 115 99
             104 97 116 111 108 111 103 121 32 40 83 32 79 32
             81 32 83 117 114 118 41 4 0 10 83 105 122 101 79
             110 68 105 115 107 0 0 0 0 0 0 0 0 8 0 13 103 101
             110 101 114 97 116 111 114 78 97 109 101 0 11 108
             97 114 103 101 66 105 111 109 101 115 6 0 19 66
             111 114 100 101 114 87 97 114 110 105 110 103 66
             108 111 99 107 115 64 20 0 0 0 0 0 0 3 0 8 114 97
             105 110 84 105 109 101 0 1 138 247 6 0 17 66 111
             114 100 101 114 87 97 114 110 105 110 103 84 105
             109 101 64 46 0 0 0 0 0 0 4 0 18 66 111 114 100
             101 114 83 105 122 101 76 101 114 112 84 105 109
             101 0 0 0 0 0 0 0 0 3 0 8 71 97 109 101 84 121 112
             101 0 0 0 0 1 0 11 77 97 112 70 101 97 116 117 114
             101 115 1 6 0 20 66 111 114 100 101 114 68 97 109
             97 103 101 80 101 114 66 108 111 99 107 63 201 153
             153 153 153 153 154 6 0 14 66 111 114 100 101 114
             83 97 102 101 90 111 110 101 64 20 0 0 0 0 0 0 1 0
             7 114 97 105 110 105 110 103 0 3 0 11 116 104 117
             110 100 101 114 84 105 109 101 0 0 18 7 8 0 16 103
             101 110 101 114 97 116 111 114 79 112 116 105 111
             110 115 0 0 1 0 10 68 105 102 102 105 99 117 108
             116 121 3 10 0 9 71 97 109 101 82 117 108 101 115
             8 0 9 100 111 77 111 98 76 111 111 116 0 4 116 114
             117 101 8 0 17 115 104 111 119 68 101 97 116 104
             77 101 115 115 97 103 101 115 0 4 116 114 117 101
             8 0 13 100 111 77 111 98 83 112 97 119 110 105 110
             103 0 4 116 114 117 101 8 0 11 100 111 84 105 108
             101 68 114 111 112 115 0 4 116 114 117 101 8 0 19
             110 97 116 117 114 97 108 82 101 103 101 110 101
             114 97 116 105 111 110 0 4 116 114 117 101 8 0 18
             99 111 109 109 97 110 100 66 108 111 99 107 79 117
             116 112 117 116 0 4 116 114 117 101 8 0 15 100 111
             68 97 121 108 105 103 104 116 67 121 99 108 101 0
             4 116 114 117 101 8 0 16 108 111 103 65 100 109
             105 110 67 111 109 109 97 110 100 115 0 4 116 114
             117 101 8 0 13 100 111 69 110 116 105 116 121 68
             114 111 112 115 0 4 116 114 117 101 8 0 19 115 101
             110 100 67 111 109 109 97 110 100 70 101 101 100
             98 97 99 107 0 4 116 114 117 101 8 0 10 100 111 70
             105 114 101 84 105 99 107 0 4 116 114 117 101 8 0
             11 109 111 98 71 114 105 101 102 105 110 103 0 4
             116 114 117 101 8 0 15 114 97 110 100 111 109 84
             105 99 107 83 112 101 101 100 0 1 51 8 0 16 114
             101 100 117 99 101 100 68 101 98 117 103 73 110
             102 111 0 5 102 97 108 115 101 8 0 13 107 101 101
             112 73 110 118 101 110 116 111 114 121 0 5 102 97
             108 115 101 0 3 0 16 103 101 110 101 114 97 116
             111 114 86 101 114 115 105 111 110 0 0 0 0 0 0))


    (define (run-tests)
      (let ((parsed (nbt-bytevector->sexp test-data)))
        (snow-pretty-print parsed)
        (newline)
        #t))

    ))
